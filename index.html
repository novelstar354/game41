<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Popã‚¿ã‚¤ãƒ”ãƒ³ã‚°</title>

<style>
body{
    margin:0;
    font-family:Arial, sans-serif;
    background:linear-gradient(180deg,#111,#222);
    color:white;
    text-align:center;
    overflow:hidden;
}

#word{ font-size:32px; margin:20px; }
#score,#timer{ font-size:20px; margin:5px; }

button{
    padding:10px 20px;
    font-size:18px;
    cursor:pointer;
}

.pop{
    position:absolute;
    font-size:24px;
    animation:popAnim 0.8s forwards;
}

@keyframes popAnim{
    0%{ transform:translateY(0) scale(0.5); opacity:1;}
    50%{ transform:translateY(-80px) scale(1.5);}
    100%{ transform:translateY(-150px) scale(0.8); opacity:0;}
}

#result{
    position:fixed;
    top:0; left:0;
    width:100%; height:100%;
    background:rgba(0,0,0,0.85);
    display:none;
    align-items:center;
    justify-content:center;
}

.resultBox{
    background:#222;
    padding:30px;
    border-radius:12px;
    box-shadow:0 0 25px gold;
}

#titleRank{
    font-size:26px;
    margin-top:15px;
    font-weight:bold;
}
</style>
</head>
<body>

<h1>ğŸ¿ Popã‚¿ã‚¤ãƒ”ãƒ³ã‚°</h1>
<div id="timer">æ®‹ã‚Šæ™‚é–“: 60</div>
<div id="score">ãƒãƒƒãƒ—æ•°: 0</div>
<div id="word">Press Space to Start</div>
<button onclick="startGame()">ã‚¹ã‚¿ãƒ¼ãƒˆ</button>

<div id="result">
  <div class="resultBox">
      <h2>çµæœç™ºè¡¨</h2>
      <div id="finalScore"></div>
      <div id="accuracy"></div>
      <div id="titleRank"></div>
      <div id="highScore"></div>
      <br>
      <button onclick="closeResult()">ã‚‚ã†ä¸€åº¦ãƒ—ãƒ¬ã‚¤</button>
      <button id="reloadButton">ã‚¿ã‚¤ãƒˆãƒ«ã«æˆ»ã‚‹</button>
  </div>
</div>
<script src="wordspop.js"></script>
<script>
// =====================
// â˜… ç§°å·ãƒ‡ãƒ¼ã‚¿ï¼ˆã“ã“ã«è¿½åŠ ã™ã‚‹ã ã‘ï¼‰
// =====================
const titles = [
  { min: 0,   name: "ãƒãƒƒãƒ—åˆå¿ƒè€…",      color: "#888" },
  { min: 50,  name: "è¦‹ç¿’ã„ãƒãƒƒãƒ‘ãƒ¼",    color: "#00ccff" },
  { min: 100, name: "ãƒãƒƒãƒ—è·äºº",        color: "#00ff88" },
  { min: 200, name: "ãƒãƒƒãƒ—ãƒã‚¹ã‚¿ãƒ¼",    color: "#ffaa00" },
  { min: 350, name: "ä¼èª¬ã®ãƒãƒƒãƒ—ç‹",    color: "#ff4444" },
  { min: 500, name: "ğŸ¿ ç¥ãƒãƒƒãƒ—é™è‡¨ ğŸ¿", color: "gold" }
];
// â†‘ã“ã“ã«å¢—ã‚„ã™ã ã‘ã§OKï¼
// ä¾‹:
// { min: 800, name: "å®‡å®™ãƒãƒƒãƒ—ç¥", color: "cyan" },



let currentWord="",index=0,score=0,time=60,timer=null;
let playing=false,totalTyped=0,correctTyped=0;

const wordDiv=document.getElementById("word");
const scoreDiv=document.getElementById("score");
const timerDiv=document.getElementById("timer");

function getTitle(score){
    let result = titles[0];
    for(let t of titles){
        if(score >= t.min){
            result = t;
        }
    }
    return result;
}

function newWord(){
    currentWord=words[Math.floor(Math.random()*words.length)];
    index=0;
    updateWord();
}

function updateWord(){
    wordDiv.innerHTML="<span style='color:#00ff88'>"+
        currentWord.slice(0,index)+"</span>"+currentWord.slice(index);
}

function createPop(){
    const pop=document.createElement("div");
    pop.className="pop";
    pop.textContent="ğŸ¿";
    pop.style.left=Math.random()*window.innerWidth+"px";
    pop.style.top=(window.innerHeight-100)+"px";
    document.body.appendChild(pop);
    setTimeout(()=>pop.remove(),800);
}

function startGame(){
    score=0; time=60;
    totalTyped=0; correctTyped=0;
    playing=true;
    scoreDiv.textContent="ãƒãƒƒãƒ—æ•°: "+score;
    timerDiv.textContent="æ®‹ã‚Šæ™‚é–“: "+time;
    document.getElementById("result").style.display="none";
    newWord();

    timer=setInterval(()=>{
        time--;
        timerDiv.textContent="æ®‹ã‚Šæ™‚é–“: "+time;
        if(time<=0){
            clearInterval(timer);
            playing=false;
            showResult();
        }
    },1000);
}

function showResult(){
    const acc = totalTyped===0?0:Math.floor((correctTyped/totalTyped)*100);
    let high = localStorage.getItem("popHighScore")||0;
    if(score>high){
        high=score;
        localStorage.setItem("popHighScore",high);
    }

    const titleData = getTitle(score);

    document.getElementById("finalScore").textContent="æœ€çµ‚ãƒãƒƒãƒ—æ•°: "+score;
    document.getElementById("accuracy").textContent="æ­£ç¢ºç‡: "+acc+"%";

    const titleDiv = document.getElementById("titleRank");
    titleDiv.textContent="ç§°å·: "+titleData.name;
    titleDiv.style.color = titleData.color;

    document.getElementById("highScore").textContent="ãƒã‚¤ã‚¹ã‚³ã‚¢: "+high;
    document.getElementById("result").style.display="flex";
}

function closeResult(){
    wordDiv.textContent="Press Space to Start";
}

document.addEventListener("keydown",(e)=>{
    if(!playing){
        if(e.code==="Space") startGame();
        return;
    }

    totalTyped++;

    if(e.key===currentWord[index]){
        index++;
        score++;
        correctTyped++;
        scoreDiv.textContent="ãƒãƒƒãƒ—æ•°: "+score;
        createPop();
        updateWord();
        if(index>=currentWord.length) newWord();
    }
});
document.getElementById('reloadButton').addEventListener('click', function() {
    window.location.reload(); // ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿
});
</script>

</body>
</html>
